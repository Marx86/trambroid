{% extends "base.html" %}
{% load coretags %}

{% block content %}
    {% load comments %}
    <div class="blog-detail content-detail">
      <div class="blog-detail-header content-detail-header">
        <h4>{{ content.title }}</h4>
      </div>
      <div class="blog-detail-body content-detail-body">
        <div class="blog-author content-author">Posted by {% if content.author.first_name or content.author.last_name %}{{ content.author.first_name }} {{ content.author.last_name }}{% else %}{{ content.author.username }}{% endif %} on {{ content.create_time }}</div>
        <div class="float-left user-avatar">
          <div class="avatar-wrapper">
            <img src="{{ content.author.profile.avatar.url }}">
            <div class="avatar-shadow"></div>
          </div>
        </div>
        {% vote %}
        <div class="blog-detail-body-content content-detail-body-content">
          {% if user.is_superuser %}{{ content.body|safe }}{% else %}{{ content.body|striptags|linebreaks }}{% endif %}
        </div>
        <div class="blog-detail-footer content-detail-footer">
        {% if content.tags.all %}
        <span class="float-left">
        <small>
          Tags:
          {% for t in content.tags.all %}
            <a href="/tag/{{ t.slug }}">{{ t.name }}</a>{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </small>
        </span>
        {% endif %}
        {% if user.is_authenticated %}<small><a class="btn" href="#comment_form">Add Comment</a></small>{% endif %}
        <small><a class="btn" href="#">{% if content.author.first_name or content.author.last_name %}{{ content.author.first_name }} {{ content.author.last_name }}{% else %}{{ content.author.username }}{% endif %} blog</a></small>
        </div>
      </div>
    <a name="comments"></a>
    {% get_comment_list for content as comments %}
    {% for comment in comments %}
      <div class="comment" id="comment_{{ comment.pk }}">
        <div class="comment-header">
          {{ comment.submit_date }}. Posted by <a href="#">{% if comment.user.first_name or comment.user.last_name %}{{ comment.user.first_name }} {{ comment.user.last_name }}{% else %}{{ comment.user.username }}{% endif %}</a>
          <span class="float-right">
            <a href="#comment_{{ comment.pk }}">#{{ comment.pk }}</a>
          </span>
        </div>
        <div class="float-left user-avatar">
            <div class="avatar-wrapper">
              <img src="{{ comment.user.profile.avatar.url }}">
              <div class="avatar-shadow"></div>
            </div>
        </div>
        <div class="comment-wrapper">
          <div class="comment-body">
            {{ comment.comment }}
          </div>
          <div class="comment-footer">
          {% if comment.user.is_superuser or comment.user.is_staff %}{{ comment.user.profile.signature|safe }}{% else %}{{ comment.user.profile.signature|striptags }}{% endif %}
        </div>
        </div>
      </div>
    {% endfor %}
    <a name="comment_form"></a>
    <br>{% render_comment_form for content %}
    </div>
{% endblock %}
